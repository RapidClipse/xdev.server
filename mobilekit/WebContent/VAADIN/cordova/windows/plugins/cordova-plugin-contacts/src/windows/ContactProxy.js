cordova.define("cordova-plugin-contacts.ContactProxy",function(e,n,t){function a(e){var n=new u;n.displayName=e.displayName||e.name,n.nickname=e.name,n.id=e.id,n.name=new s(e.displayName||e.name,e.lastName,e.firstName||e.name,e.middleName,e.honorificNamePrefix||e.honorificPrefix,e.honorificNameSuffix||e.honorificSuffix),n.phoneNumbers=[];var t,a=e.phoneNumbers||e.phones;for(t=0;a.size>t;t++){var o=a[t],d=new r(o.category||o.kind,o.value||o.number);n.phoneNumbers.push(d)}n.emails=[];var f=e.emails;for(t=0;f.size>t;t++){var m=f[t],l=new r(m.category||m.kind,m.value||m.address);n.emails.push(l)}n.addresses=[];var p=e.locations||e.addresses;for(t=0;p.size>t;t++){var v=p[t],h=new i(null,v.category||v.kind,v.unstructuredAddress,v.street||v.streetAddress,v.city||v.locality,v.region,v.postalCode,v.country);n.addresses.push(h)}n.ims=[];var C=e.instantMessages||e.connectedServiceAccounts;for(t=0;C.size>t;t++){var y=C[t],R=new r(y.category||y.serviceName,y.userName||y.id);n.ims.push(R)}var N=e.jobInfo;if(N){n.organizations=[];for(var A=0;N.size>A;A++){var g=N[t];n.organizations.push(new c(!1,null,g.companyName,g.department,g.title))}}var w=e.notes;w&&(n.note=w);var O=e.thumbnail;return O&&O.path&&(n.photos=[new r("url",URL.createObjectURL(O),!1)]),n}function o(e){var n=new f.Contact;if(e.name&&(n.displayNameOverride=e.name.formatted,n.firstName=e.name.givenName,n.middleName=e.name.middleName,n.lastName=e.name.familyName,n.honorificNamePrefix=e.name.honorificPrefix,n.honorificNameSuffix=e.name.honorificSuffix),n.nickname=e.nickname,e.phoneNumbers&&e.phoneNumbers.forEach(function(e){var t=new f.ContactPhone;t.description=e.type,t.number=e.value,n.phones.push(t)}),e.emails&&e.emails.forEach(function(e){var t=new f.ContactEmail;t.description=e.type,t.address=e.value,n.emails.push(t)}),e.addresses&&e.addresses.forEach(function(e){var t=new f.ContactAddress;t.description=e.type,t.streetAddress=e.streetAddress,t.locality=e.locality,t.region=e.region,t.postalCode=e.postalCode,t.country=e.country,n.addresses.push(t)}),e.ims&&e.ims.forEach(function(e){var t=new f.ContactConnectedServiceAccount;t.serviceName=e.type,t.id=e.value,n.connectedServiceAccounts.push(t)}),e.organizations&&e.organizations.forEach(function(e){var t=new f.ContactJobInfo;t.companyName=e.name,t.department=e.department,t.description=e.type,t.title=e.title,n.jobInfo.push(t)}),n.notes=e.note,e.photos){var t=e.photos.filter(function(e){return e.value!==void 0});if(t.length>0){var a=t[0],o=a.value;try{var r;r=/^([a-z][a-z0-9+\-.]*):\/\//i.test(o)?Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(new Windows.Foundation.Uri(o)):Windows.Storage.Streams.RandomAccessStreamReference.createFromFile(o),n.thumbnail=r}catch(i){}}}return n}var r=e("./ContactField"),i=e("./ContactAddress"),c=e("./ContactOrganization"),s=e("./ContactName"),d=e("./ContactError"),u=e("./Contact"),f=Windows.ApplicationModel.Contacts;t.exports={pickContact:function(e,n){var t=navigator.userAgent.indexOf("Windows Phone")!==-1,o=new f.ContactPicker;t&&o.desiredFieldsWithContactFieldType.append(Windows.ApplicationModel.Contacts.ContactFieldType.phoneNumber);var r=o.pickContactAsync?o.pickContactAsync():o.pickSingleContactAsync();r.done(function(o){if(!o){var r=new d(d.OPERATION_CANCELLED_ERROR);return r.message="User did not pick a contact.",n(r),void 0}return t?(f.ContactManager.requestStoreAsync().done(function(t){t.getContactAsync(o.id).done(function(n){e(a(n))},function(){n(new d(d.UNKNOWN_ERROR))})},function(){n(new d(d.UNKNOWN_ERROR))}),void 0):(e(a(o)),void 0)})},save:function(e,n,t){if(f.ContactList===void 0)return n&&n(d.NOT_SUPPORTED_ERROR),void 0;var r=o(t[0]);f.ContactManager.requestStoreAsync(f.ContactStoreAccessType.appContactsReadWrite).then(function(e){return e.findContactListsAsync().then(function(n){return n.length>0?n[0]:e.createContactListAsync("")},function(){return e.createContactListAsync("")})}).then(function(e){return e.saveContactAsync(r)}).done(function(){e(a(r))},function(e){n(e)})},remove:function(e,n,t){return f.ContactList===void 0?(n&&n(d.NOT_SUPPORTED_ERROR),void 0):(WinJS.Promise.join([f.ContactManager.requestStoreAsync(f.ContactStoreAccessType.appContactsReadWrite),f.ContactManager.requestStoreAsync(f.ContactStoreAccessType.allContactsReadOnly)]).then(function(e){var n=e[1],a=e[0],o=a.getContactReader();return o.readBatchAsync().then(function(e){if(e.status!==f.ContactBatchStatus.success)throw new d(d.IO_ERROR);var n=e.contacts.filter(function(e){return e.id===t[0]});if(n.length===0)throw new d(d.IO_ERROR);return n[0]}).then(function(e){return n.aggregateContactManager.findRawContactsAsync(e)}).then(function(e){return a.findContactListsAsync().then(function(n){var t=null,a=null,o=n.some(function(n){for(var o=0;e.length>o;o++)if(e[o].contactListId===n.id)return t=n,a=e[o],!0;return!1});if(!o)throw new d(d.IO_ERROR);return t.deleteContactAsync(a)})})}).done(function(){e()},function(e){n(e)}),void 0)},search:function(e,n,t){var o=(t[0],t[1]),r=o.filter,i=o&&o.multiple;if(!f.ContactManager||!f.ContactManager.requestStoreAsync)return n(new d(d.NOT_SUPPORTED_ERROR)),void 0;var c=f.ContactManager.requestStoreAsync();c.done(function(t){var o=r?t.findContactsAsync(r):t.findContactsAsync();o.done(function(n){var t=[];if(n.size!==0){var o=i?n:[n[0]];o.forEach(function(e){t.push(a(e))})}e(t)},function(){n(new d(d.UNKNOWN_ERROR))})},function(){n(new d(d.UNKNOWN_ERROR))})}},e("cordova/exec/proxy").add("Contacts",t.exports)})