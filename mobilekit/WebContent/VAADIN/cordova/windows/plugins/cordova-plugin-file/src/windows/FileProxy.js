cordova.define("cordova-plugin-file.FileProxy",function(n,e,t){function i(n,e,t,i,o,r){this.isFile=!!n,this.isDirectory=!!e,this.name=t||"",this.fullPath=i||"",this.filesystemName=o||null,this.nativeURL=r||null}function o(n,e,t){return n.openAsync(Windows.Storage.FileAccessMode.readWrite).then(function(n){n.seek(t);var i=new Windows.Storage.Streams.DataWriter(n);return i.writeBytes(e),i.storeAsync().then(function(e){return n.size=t+e,i.flushAsync().then(function(){return n.close(),e})})})}function r(n,e,t){return n.openAsync(Windows.Storage.FileAccessMode.readWrite).then(function(n){n.seek(t);var i=new Windows.Storage.Streams.DataWriter(n);return i.writeString(e),i.storeAsync().then(function(e){return n.size=t+e,i.flushAsync().then(function(){return n.close(),e})})})}function a(n,e,t){return n.openAsync(Windows.Storage.FileAccessMode.readWrite).then(function(n){n.seek(t);var i=e.size,o=(e.detachStream||e.msDetachStream).call(e);return Windows.Storage.Streams.RandomAccessStream.copyAsync(o,n).then(function(){return n.size=t+i,n.flushAsync().then(function(){return o.close(),n.close(),i})})})}function s(n,e,t){return a(n,new Blob([e]),t)}function c(n){var e=n.replace(/\//g,"\\");return e=e.replace(/\\+/g,"\\")}function f(n){var e=n.replace(/\\/g,"/");return e}function u(n){return!L.test(n.replace(U,""))}function l(n){for(var e=RegExp("/{2,}","g"),t=n.replace(e,"/").split(/\/+/),i=0;t.length>i;++i)t[i]===".."&&(t.splice(i,1),i>0&&(t.splice(i-1,1),--i));return t.join("/")}function d(){return W||(W={persistent:Object.freeze(new x("persistent",{name:"persistent",nativeURL:"ms-appdata:///local",winpath:f(Windows.Storage.ApplicationData.current.localFolder.path)})),temporary:Object.freeze(new x("temporary",{name:"temporary",nativeURL:"ms-appdata:///temp",winpath:f(Windows.Storage.ApplicationData.current.temporaryFolder.path)})),root:Object.freeze(new x("root",{name:"root",winpath:""}))}),W}function R(n){return d()[n]}function p(n){var e,t=d();return Object.keys(t).some(function(i){var o=t[i];return n.indexOf(o.winpath)===0&&(e=o),e}),e}function v(n){n=n.replace(b,"ms-appdata:///");var e=decodeURIComponent(n);return/\?/g.test(e)&&(e=(e+"").split("?")[0]),e.indexOf("file:/")===0&&e.indexOf("file://")!==0&&(n="file:///"+n.substr(6)),["file://","ms-appdata:///","cdvfile://localhost/"].every(function(n){if(e.indexOf(n)!==0)return!0;var t=e.indexOf("/",n.length);e=0>t?"":l(e.substr(t))}),e.replace(U,"$1")}function O(n){n=n.replace(b,"ms-appdata:///");var e;if(n.indexOf("file:/")===0)e=p(v(n));else{var t=d();Object.keys(t).every(function(i){var o=t[i];return n.indexOf(o.root.nativeURL)===0||n.indexOf("cdvfile://localhost/"+o.name+"/")===0?(e=o,!1):!0})}return e}function h(n,e){var t=f(e);return t.indexOf(n.winpath)!==0?null:t.replace(n.winpath,"/")}function _(n,e){return e=e?e:{},new WinJS.Promise(function(t,i){C(n).done(function(n){t({file:n})},function(o){o.number!=P.fileNotFound&&o.number!=P.invalidArgument&&i(A.NOT_READABLE_ERR),T(n).done(function(n){e.getContent?WinJS.Promise.join({files:n.getFilesAsync(),folders:n.getFoldersAsync()}).done(function(e){t({folder:n,files:e.files,folders:e.folders})},function(){i(A.NOT_READABLE_ERR)}):t({folder:n})},function(n){n.number==P.fileNotFound||n.number==P.invalidArgument?t({}):i(A.NOT_READABLE_ERR)})})})}function m(n,e,t){return t=t?t:n.name,new WinJS.Promise(function(i,o){WinJS.Promise.join({fld:e.createFolderAsync(t,Windows.Storage.CreationCollisionOption.openIfExists),files:n.getFilesAsync(),folders:n.getFoldersAsync()}).done(function(n){if(!n.files.length&&!n.folders.length)return i(),void 0;var t=n.files.length,r=function(){return t--?(m(n.folders[t],e).done(function(){r()},o),void 0):(i(),void 0)},a=function(){return t--?(n.files[t].copyAsync(n.fld).done(function(){a()},o),void 0):(t=n.folders.length,r(),void 0)};a()},o)})}function N(n,e,t){return t=t?t:n.name,new WinJS.Promise(function(i,o){WinJS.Promise.join({fld:e.createFolderAsync(t,Windows.Storage.CreationCollisionOption.openIfExists),files:n.getFilesAsync(),folders:n.getFoldersAsync()}).done(function(t){if(!t.files.length&&!t.folders.length)return i(),void 0;var r=t.files.length,a=function(){return r--?(N(t.folders[r],e).done(a,o),void 0):(n.deleteAsync().done(i,o),void 0)},s=function(){return r--?(t.files[r].moveAsync(t.fld).done(function(){s()},o),void 0):(r=t.folders.length,a(),void 0)};s()},o)})}function E(n,e,t,i){var o=t[0],r=t[1],a=t[2],s=O(o),f=O(r),d=v(o),R=v(r);if(!(s&&f&&u(a)))return e(A.ENCODING_ERR),void 0;var p=c(l(s.winpath+d)),h=c(l(f.winpath+R)),m=l(R+"/"+a),N=c(l(f.winpath+R+"/"+a));return p==h||p==N?(e(A.INVALID_MODIFICATION_ERR),void 0):(WinJS.Promise.join({src:_(p),dst:_(h),tgt:_(N,{getContent:!0})}).done(function(t){return t.dst.folder&&(t.src.folder||t.src.file)?t.src.folder&&t.tgt.file||t.src.file&&t.tgt.folder||t.tgt.folder&&(t.tgt.files.length||t.tgt.folders.length)?(e(A.INVALID_MODIFICATION_ERR),void 0):(t.src.file?i.fileOp(t.src.file,t.dst.folder,a,Windows.Storage.NameCollisionOption.replaceExisting).done(function(){n(new F(a,m,f.name,f.makeNativeURL(m)))},function(){e(A.INVALID_MODIFICATION_ERR)}):i.folderOp(t.src.folder,t.dst.folder,a).done(function(){n(new S(a,m,f.name,f.makeNativeURL(m)))},function(){e(A.INVALID_MODIFICATION_ERR)}),void 0):(e(A.NOT_FOUND_ERR),void 0)},function(){e(A.INVALID_MODIFICATION_ERR)}),void 0)}var g=n("./File"),A=n("./FileError"),I=n("./Flags"),y=n("./FileSystem"),w=n("./LocalFileSystem"),D=n("cordova/utils"),F=function(n,e,t,i){F.__super__.constructor.apply(this,[!0,!1,n,e,t,i])};D.extend(F,i);var S=function(n,e,t,i){S.__super__.constructor.call(this,!1,!0,n,e,t,i)};D.extend(S,i);var T=Windows.Storage.StorageFolder.getFolderFromPathAsync,C=Windows.Storage.StorageFile.getFileFromPathAsync,U=RegExp("^[/]*([A-Z]:)"),L=/[\\?*|"<>:]/,x=function(n,e){this.winpath=e.winpath,this.winpath&&!/\/$/.test(this.winpath)&&(this.winpath+="/"),this.makeNativeURL=function(n){return y.encodeURIPath(this.root.nativeURL+l(n.replace(":","%3A")))},e.fullPath="/",e.nativeURL||(e.nativeURL="file://"+l(this.winpath+e.fullPath).replace(":","%3A")),x.__super__.constructor.call(this,n,e)};D.extend(x,y),x.prototype.__format__=function(n){var e=l("/"+this.name+(n[0]==="/"?"":"/")+y.encodeURIPath(n));return"cdvfile://localhost"+e};var W,M={dataDirectory:"ms-appdata:///local/",cacheDirectory:"ms-appdata:///temp/",tempDirectory:"ms-appdata:///temp/",syncedDataDirectory:"ms-appdata:///roaming/",applicationDirectory:"ms-appx:///",applicationStorageDirectory:"ms-appx:///"};y.prototype.__format__=function(n){return R(this.name).__format__(n)},n("./fileSystems").getFs=function(n,e){setTimeout(function(){e(R(n))})};var b=RegExp("^ms-appdata://localhost/"),P={invalidArgument:-0xNaN,fileNotFound:-0xNaN,accessDenied:-0xNaN};t.exports={requestAllFileSystems:function(){return d()},requestAllPaths:function(n){n(M)},getFileMetadata:function(n,e,i){t.exports.getMetadata(n,e,i)},getMetadata:function(n,e,t){var i=O(t[0]),o=v(t[0]);if(!i||!u(o))return e(A.ENCODING_ERR),void 0;var r=c(i.winpath+o),a=function(t){t.getBasicPropertiesAsync().then(function(e){n(new g(t.name,t.path,t.fileType,e.dateModified,e.size))},function(){e(A.NOT_READABLE_ERR)})},s=function(t){t.getBasicPropertiesAsync().then(function(e){var t={size:e.size,lastModifiedDate:e.dateModified};n(t)},function(){e(A.NOT_READABLE_ERR)})};C(r).then(a,function(){T(r).then(s,function(){e(A.NOT_FOUND_ERR)})})},getParent:function(n,e,t){var i=O(t[0]),o=v(t[0]);if(!i||!u(o))return e(A.ENCODING_ERR),void 0;if(!o||RegExp("/[^/]*/?$").test(o))return n(new S(i.root.name,i.root.fullPath,i.name,i.makeNativeURL(i.root.fullPath))),void 0;var r=o.replace(RegExp("/[^/]+/?$","g"),""),a=o.substr(r.length),s=c(i.winpath+r),f=new S(a,r,i.name,i.makeNativeURL(r));T(s).done(function(){n(f)},function(){e(A.INVALID_STATE_ERR)})},readAsText:function(n,e,t){var i=t[0],o=t[1],r=t[2],a=t[3],s=O(i),f=v(i);if(!s)return e(A.ENCODING_ERR),void 0;var u=c(l(s.winpath+f)),d=Windows.Storage.Streams.UnicodeEncoding.utf8;o=="Utf16LE"||o=="utf16LE"?d=Windows.Storage.Streams.UnicodeEncoding.utf16LE:(o=="Utf16BE"||o=="utf16BE")&&(d=Windows.Storage.Streams.UnicodeEncoding.utf16BE),C(u).then(function(n){return n.openReadAsync()}).then(function(n){r=0>r?Math.max(n.size+r,0):Math.min(n.size,r),a=0>a?Math.max(a+n.size,0):Math.min(n.size,a),n.seek(r);var e=a-r,t=new Windows.Storage.Streams.Buffer(e);return n.readAsync(t,e,Windows.Storage.Streams.InputStreamOptions.none)}).done(function(t){try{n(Windows.Security.Cryptography.CryptographicBuffer.convertBinaryToString(d,t))}catch(i){e(A.ENCODING_ERR)}},function(){e(A.NOT_FOUND_ERR)})},readAsBinaryString:function(n,e,t){var i=t[0],o=t[1],r=t[2],a=O(i),s=v(i);if(!a)return e(A.ENCODING_ERR),void 0;var f=c(l(a.winpath+s));C(f).then(function(e){Windows.Storage.FileIO.readBufferAsync(e).done(function(e){var t=Windows.Storage.Streams.DataReader.fromBuffer(e),i=new Uint8Array(e.length),a="";t.readBytes(i),t.close();for(var s=0;i.length>s;s++){var c=i[s],f=String.fromCharCode(c);a+=f}n(a.slice(o,r))})},function(){e(A.NOT_FOUND_ERR)})},readAsArrayBuffer:function(n,e,t){var i=t[0],o=O(i),r=v(i);if(!o)return e(A.ENCODING_ERR),void 0;var a=c(l(o.winpath+r));C(a).then(function(e){var i=MSApp.createFileFromStorageFile(e),o=URL.createObjectURL(i,{oneTimeOnly:!0}),r=new XMLHttpRequest;r.open("GET",o,!0),r.responseType="arraybuffer",r.onload=function(){var e=r.response,i=t[1]||0,o=t[2]||e.length;if(i!==0||o!==e.length)if(e.slice)e=e.slice(i,o);else{for(var a=new Uint8Array(e),s=new ArrayBuffer(o-i),c=new Uint8Array(s),f=0;c.length>f;f++)c[f]=a[f+i];e=s}n(e)},r.send()},function(){e(A.NOT_FOUND_ERR)})},readAsDataURL:function(n,e,t){var i=t[0],o=O(i),r=v(i);if(!o)return e(A.ENCODING_ERR),void 0;var a=c(l(o.winpath+r));C(a).then(function(e){Windows.Storage.FileIO.readBufferAsync(e).done(function(t){var i=Windows.Security.Cryptography.CryptographicBuffer.encodeToBase64String(t);(i+"").substr(0,4)=="77u/"&&(i=i.substr(4));var o=e.contentType,r="data:"+o+";base64,"+i;n(r)})},function(){e(A.NOT_FOUND_ERR)})},getDirectory:function(n,e,t){var i=t[0],o=t[1],r=t[2],a=O(i),s=v(i);if(!a||!u(o))return e(A.ENCODING_ERR),void 0;var f=l(s+"/"+o),d=l(a.winpath+f),R=d.substring(d.lastIndexOf("/")+1),p=c(d.substring(0,d.lastIndexOf("/"))),h="";h=r?new I(r.create,r.exclusive):new I(!1,!1),T(p).done(function(t){h.create===!0&&h.exclusive===!0?t.createFolderAsync(R,Windows.Storage.CreationCollisionOption.failIfExists).done(function(e){n(new S(e.name,f,a.name,a.makeNativeURL(f)))},function(){e(A.PATH_EXISTS_ERR)}):h.create===!0&&h.exclusive===!1?t.createFolderAsync(R,Windows.Storage.CreationCollisionOption.openIfExists).done(function(e){n(new S(e.name,f,a.name,a.makeNativeURL(f)))},function(){e(A.INVALID_MODIFICATION_ERR)}):h.create===!1&&t.getFolderAsync(R).done(function(e){n(new S(e.name,f,a.name,a.makeNativeURL(f)))},function(){t.getFileAsync(R).done(function(){e(A.TYPE_MISMATCH_ERR)},function(){e(A.NOT_FOUND_ERR)})})},function(){e(A.NOT_FOUND_ERR)})},remove:function(n,e,t){var i=O(t[0]),o=v(t[0]);if(!i||!u(o))return e(A.ENCODING_ERR),void 0;if(!o||o=="/")return e(A.NO_MODIFICATION_ALLOWED_ERR),void 0;var r=c(i.winpath+o);C(r).then(function(t){t.deleteAsync().done(n,function(){e(A.INVALID_MODIFICATION_ERR)})},function(){T(r).done(function(t){t.getFilesAsync().then(function(n){if(n){if(n.length===0)return t.getFoldersAsync();e(A.INVALID_MODIFICATION_ERR)}}).done(function(i){i&&(i.length===0?t.deleteAsync().done(n,function(){e(A.INVALID_MODIFICATION_ERR)}):e(A.INVALID_MODIFICATION_ERR))})},function(){e(A.NOT_FOUND_ERR)})})},removeRecursively:function(n,e,t){var i=O(t[0]),o=v(t[0]);if(!i||!u(o))return e(A.ENCODING_ERR),void 0;if(!o||o=="/")return e(A.NO_MODIFICATION_ALLOWED_ERR),void 0;var r=c(i.winpath+o);T(r).done(function(t){t.deleteAsync().done(function(e){n(e)},function(n){e(n)})},function(){e(A.FILE_NOT_FOUND_ERR)})},getFile:function(n,e,t){var i=t[0],o=t[1],r=t[2],a=O(i),s=v(i);if(!a||!u(o))return e(A.ENCODING_ERR),void 0;var f=l(s+"/"+o),d=l(a.winpath+f),R=d.substring(d.lastIndexOf("/")+1),p=c(d.substring(0,d.lastIndexOf("/"))),h="";h=r!==null?new I(r.create,r.exclusive):new I(!1,!1),T(p).done(function(t){h.create===!0&&h.exclusive===!0?t.createFileAsync(R,Windows.Storage.CreationCollisionOption.failIfExists).done(function(e){n(new F(e.name,f,a.name,a.makeNativeURL(f)))},function(){e(A.PATH_EXISTS_ERR)}):h.create===!0&&h.exclusive===!1?t.createFileAsync(R,Windows.Storage.CreationCollisionOption.openIfExists).done(function(e){n(new F(e.name,f,a.name,a.makeNativeURL(f)))},function(){e(A.INVALID_MODIFICATION_ERR)}):h.create===!1&&t.getFileAsync(R).done(function(e){n(new F(e.name,f,a.name,a.makeNativeURL(f)))},function(){t.getFolderAsync(R).done(function(){e(A.TYPE_MISMATCH_ERR)},function(){e(A.NOT_FOUND_ERR)})})},function(n){e(n.number==P.accessDenied?A.SECURITY_ERR:A.NOT_FOUND_ERR)})},readEntries:function(n,e,t){var i=O(t[0]),o=v(t[0]);if(!i||!u(o))return e(A.ENCODING_ERR),void 0;var r=c(i.winpath+o),a=[];T(r).done(function(t){var o=[],r=0;o[r++]=t.getFilesAsync().then(function(n){if(n!==null)for(var t=0;n.length>t;t++){var o=h(i,n[t].path);if(!o)return e(A.NOT_FOUND_ERR),void 0;a.push(new F(n[t].name,o,i.name,i.makeNativeURL(o)))}}),o[r++]=t.getFoldersAsync().then(function(n){if(n!==null)for(var t=0;n.length>t;t++){var o=h(i,n[t].path);if(!o)return e(A.NOT_FOUND_ERR),void 0;a.push(new S(n[t].name,o,i.name,i.makeNativeURL(o)))}}),WinJS.Promise.join(o).then(function(){n(a)})},function(){e(A.NOT_FOUND_ERR)})},write:function(n,e,t){function i(n,e){if(n instanceof Blob)return a;if(n instanceof ArrayBuffer)return s;if(e)return o;if(typeof n=="string")return r;throw Error("Unsupported data type for write method")}var f=t[0],u=t[1],d=t[2],R=t[3],p=O(f),h=v(f);if(!p)return e(A.ENCODING_ERR),void 0;var _=l(p.winpath+h),m=_.substring(_.lastIndexOf("/")+1),N=_.substring(0,_.lastIndexOf("/")),E=c(N),g=i(u,R);T(E).done(function(t){t.createFileAsync(m,Windows.Storage.CreationCollisionOption.openIfExists).done(function(t){g(t,u,d).done(function(e){var t=e||u.length;n(t)},function(){e(A.INVALID_MODIFICATION_ERR)})},function(){e(A.INVALID_MODIFICATION_ERR)})},function(){e(A.NOT_FOUND_ERR)})},truncate:function(n,e,t){var i=t[0],o=t[1],r=O(i),a=v(i);if(!r)return e(A.ENCODING_ERR),void 0;var s=l(r.winpath+a),f=c(s),u=c(s.substring(0,s.lastIndexOf("/")));C(f).done(function(t){var i=0;t.getBasicPropertiesAsync().then(function(r){return i=r.size,i>Number(o)?(0>Number(o)||Windows.Storage.FileIO.readTextAsync(t,Windows.Storage.Streams.UnicodeEncoding.utf8).then(function(i){i=i.substr(0,o);var r=t.name;t.deleteAsync().then(function(){return T(u)}).done(function(t){t.createFileAsync(r).then(function(t){Windows.Storage.FileIO.writeTextAsync(t,i).done(function(){n((i+"").length)},function(){e(A.NO_MODIFICATION_ALLOWED_ERR)})},function(){e(A.NO_MODIFICATION_ALLOWED_ERR)})})},function(){e(A.NOT_FOUND_ERR)}),void 0):(n(this.length),void 0)})},function(){e(A.NOT_FOUND_ERR)})},copyTo:function(n,e,t){E(n,e,t,{fileOp:function(n,e,t,i){return n.copyAsync(e,t,i)},folderOp:function(n,e,t){return m(n,e,t)}})},moveTo:function(n,e,t){E(n,e,t,{fileOp:function(n,e,t,i){return n.moveAsync(e,t,i)},folderOp:function(n,e,t){return N(n,e,t)}})},tempFileSystem:null,persistentFileSystem:null,requestFileSystem:function(n,e,t){var i=t[0],o=t[1],r=1e10;if(o>r)return e(A.QUOTA_EXCEEDED_ERR),void 0;var a;switch(i){case w.TEMPORARY:a=R("temporary");break;case w.PERSISTENT:a=R("persistent")}a?n(a):e(A.NOT_FOUND_ERR)},resolveLocalFileSystemURI:function(n,e,t){var i=t[0],o=v(i),r=O(i);if(!r||!u(o))return e(A.ENCODING_ERR),void 0;o.indexOf(r.winpath)===0&&(o=o.substr(r.winpath.length));var a=c(r.winpath+o);C(a).done(function(e){n(new F(e.name,o,r.name,r.makeNativeURL(o)))},function(){T(a).done(function(e){n(new S(e.name,o,r.name,r.makeNativeURL(o)))},function(){e(A.NOT_FOUND_ERR)})})}},n("cordova/exec/proxy").add("File",t.exports)})